pico-8 cartridge // http://www.pico-8.com
version 43
__lua__
function _init()
  spr_size=8
  fancyfill_ct=1
  fancyfill={
    0b1010010101011010,
    0b0101010110101010,
    0b0101101010100101,
    0b1010101001010101,
  }
  player={
    stats={str=50,agl=50,lck=00},
    stats_order={"str","agl","lck"},
  }

  frame_ct=0
end

--[[
  .-----------------------.
  |32768|16384| 8192| 4096|  xoxo xoxo oxox oxox
  |-----|-----|-----|-----|  xoxo oxox oxox xoxo
  | 2048| 1024| 512 | 256 |  oxox oxox xoxo xoxo 
  |-----|-----|-----|-----|  oxox xoxo xoxo oxox
  | 128 |  64 |  32 |  16 |
  |-----|-----|-----|-----|
  |  8  |  4  |  2  |  1  |
  '-----------------------'
  {0b1010101001010101}
]]

-->8
function _update()
  frame_ct+=1

  -- shift bg fill every 2 frames
  if frame_ct%2==0 then
    fancyfill_ct+=1
  end
end

-->8
function _draw()
  -- bg draw
  cls(0)                   -- clear screen black
  set_fill("ff")           -- set fancy upward scrolling fill
  rectfill(0,0,128,128,1)  -- draw fill across entire screen
  fillp()                  -- reset to solid fill
	 
  -- sections
  draw_sidebar()
  -- draw_encounter()
  
end

function draw_sidebar()
  -- bg render
  map()

  -- char pic
  -- spr(1,1*spr_size,1.5*spr_size)

  -- health ----------------
  fancy_container(1,10,25,26,3,1,7)
  spr(16, 4,  14)
  spr(16, 15, 14)
  spr(17, 4,  24)
  spr(18, 15, 24)
  
  -- stats -----------------
  draw_stats()

  -- items -----------------
  fancy_container(1,92,25,26,3,1,7)
  spr(32, 4, 96)
  spr(32, 15, 96)
  spr(32, 4, 106)
  spr(32, 15, 106)


end

function fancy_container(x,y,w,h,r,f,b)
  --[[
    Draw a fancy UI container to the screen

    Args: 
      x: Starting x position
      y: Starting y position
      w: Width of the container
      h: Height of the container
      r: Border radius
      f: Fill color
      b: Border color
  ]]
  set_fill()                  -- solid fill
  rrectfill(x, y, w, h, r, f) -- fill solid
  set_fill("fr")              -- fancy fill (inv.)
  rrectfill(x, y, w, h, r, f) -- populate rect w fancy fill
  set_fill()                  -- solid fill
  rrect(x, y+1, w, h, r, 1)   -- border drop shadow
  rrect(x, y, w, h, r, b)     -- border
end

function set_fill(t)
  --[[
    Set fill type based on passed type (t)

    Opts:
      nil:  solid fill
      "ff": fancy-fill (upward scrolling)
      "ff": fancy-fill reversed (downward scrolling)
  ]]
  if     t==nil  then fillp()
  elseif t=="ff" then fillp(fancyfill[(fancyfill_ct%4)+1])
  elseif t=="fr" then fillp(fancyfill[((fancyfill_ct*-1)%4)+1])
  else error("Fill type not accounted for") end
end

function draw_stats()
  local base_height,spacing,line_gap=44,15,7
  for i=1,#player.stats_order do
    local k = player.stats_order[i]
    local v = player.stats[k]
    local val = v < 10 and "0"..v or v
    local base_y = base_height + (spacing * (i-1))
    print(k..":"..val, 2, base_y+1, 1)                   -- draw text
    print(k..":"..val, 2, base_y,   7)                   -- draw text drop shadow
    line(2, base_y+line_gap,   24, base_y+line_gap,   7) -- draw underline
    line(2, base_y+line_gap+1, 24, base_y+line_gap+1, 1) -- draw underline shadow
  end
end


__gfx__
00000000499a9aa70000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
000000009111111a0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00700700917117190000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00077000911111197a999aa77a99aaaaaa9000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
000770009171171a999449999449999949aa00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00700700911771191111111111111111194a90000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000041111119ddddddddddddddddd114a0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000044494994ddddddddddddddddddd1a0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
000000000000000000000000dddddddddddda0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0dd00dd00dd00dd00dd00dd0dddddddddddd90000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
de7dde7dde7dd55dd51dd15ddddddddddddda0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
e887e887e8875115d111111ddddddddddddda0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
e888888ee8881115d111111ddddddddddddda0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
de8888edde88115d0d1111d0dddddddddddd90000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0de88ed00de815d000d11d00dddddddddddda0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00deed0000de5d00000dd000dddddddddddda0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
000000000009dddd0009addd00000000dddda0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00d55d000009dddd00049add00000000dddd90000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0d5115d00009dddd00049add00000000dddd40000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
051111500004dddd000049ad000009aadddda0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
051111500009dddd0000099a00009aa1dddda0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0d5115d00009dddd000000000009a91ddddd90000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00d55d000009dddd000000000004941ddddd90000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
000000000009dddd000000000009a1dddddda0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
e00000020009dddddddddddddddddddddddda0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0e0000200009ddddddddddddddddddddddda90000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00e002000009dddddddddddddddddddddaa990000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
000e2000000addddaaa77a7aaa7aa7aaa99400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0002e0000009dddd9449999499994999944000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00200e000004dddd0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
020000e00009dddd0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
2000000e0009dddd0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
__map__
0302020400000000000000000000000030000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
1313132400000000000000000000000030000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
1313131400000000000000000000000030000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
1313132400000000000000000000000030000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
1313132400000000000000000000000030000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
1313132400000000000000000000000030000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
1313131400000000000000000000000030000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
1313132400000000000000000000000030000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
1313132400000000000000000000000030000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
1313132400000000000000000000000030000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
1313132400000000000000000000000030000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
1313131400000000000000000000000030000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
1313131400000000000000000000000030000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
1313132400000000000000000000000030000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
1313132400000000000000000000000030000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
3232323400000000000000000000000030000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
3030303030303030303030303030303030000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
